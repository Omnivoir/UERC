from pathlib import Path

# Updated HTML with references and fixed SOP embed
html_content = """
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Universal First Responder Master Reference</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Reset & base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f2f2f2; color: #333; }
    header { background: #b22234; color: #fff; padding: 1.5rem; text-align: center; }
    header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    header p { font-size: 1rem; opacity: 0.9; }
    nav { background: #3c3b6e; }
    nav ul { display: flex; flex-wrap: wrap; justify-content: center; list-style: none; }
    nav li { margin: 0.5rem 1rem; }
    nav a { color: #fff; text-decoration: none; font-weight: 600; }
    main { max-width: 960px; margin: 2rem auto; padding: 0 1rem; }
    section { margin-bottom: 2rem; border-radius: 8px; overflow: hidden; background: #fff;
               box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    section h2 { background: #003399; color: #fff; padding: 1rem; font-size: 1.6rem; }
    details { border-top: 1px solid #ddd; }
    summary { cursor: pointer; padding: 1rem; font-weight: 600; background: #e9ecef; transition: background 0.2s; }
    summary:hover { background: #dee2e6; }
    .details-content { padding: 1rem; border-top: 1px solid #ccc; }
    .details-content ul { margin: 0.5rem 0 0.5rem 1.2rem; list-style: disc; }
    .callout { border-left: 4px solid #b22234; background: #fff3f3; padding: 0.8rem; margin: 1rem 0; font-style: italic; }
    .references { font-size: 0.9rem; margin-top: 1rem; color: #555; }
    .button { display: inline-block; margin: 1rem 0; background: #b22234; color: #fff; padding: 0.6rem 1.2rem; text-decoration: none; border-radius: 4px; font-weight: 600; }
    footer { text-align: center; padding: 1rem; background: #3c3b6e; color: #fff; font-size: 0.9rem; }
    .pdf-embed, .pdf-object { width: 100%; height: 600px; border: none; }
    #sop-list li { margin-bottom: 0.5rem; }
    #sop-list strong { color: #b22234; }
  </style>
</head>
<body>

<header>
  <h1>Universal First Responder Master Reference</h1>
  <p>The definitive SOP-driven emergency service guide for Fire, EMS, Hazmat & Command</p>
</header>

<nav>
  <ul>
    <li><a href="#fire">Structure Fire</a></li>
    <li><a href="#hazmat">Hazmat</a></li>
    <li><a href="#ems">EMS</a></li>
    <li><a href="#pump">Pump Ops</a></li>
    <li><a href="#aerial">Aerial Ops</a></li>
    <li><a href="#mutual">Mutual Aid</a></li>
    <li><a href="#mapping">RHQC Map</a></li>
    <li><a href="#sopembed">HFD SOPs</a></li>
  </ul>
</nav>

<main>

  <section id="fire">
    <h2>🔥 Structure Fire Operations</h2>
    <details>
      <summary>Size-up & Risk Assessment</summary>
      <div class="details-content">
        <ul>
          <li>Establish command & location.</li>
          <li>Identify structure type, occupancy, exposures.</li>
          <li>Check water supply & hydrant locations.</li>
          <li>Review pre-plans & construction details.</li>
        </ul>
        <p class="references">
          <strong>References:</strong>
          SOP 900.44 | Essentials 7e Ch 12 p 290 | NFPA 1710 5.2.2 | Company Officer 6e Ch 3
        </p>
      </div>
    </details>
    <details>
      <summary>Incident Command & ICS</summary>
      <div class="details-content">
        <ul>
          <li>Implement NIMS ICS: Command, Ops, Logistics, Planning, Finance.</li>
          <li>Establish divisions/zones; ensure 4 × 4 accountability tags.</li>
          <li>PAR every 15 minutes; document on ICS 201, 202 forms.</li>
        </ul>
        <p class="references">
          SOP 900.03 | Essentials 7e Ch 2 p 45 | NFPA 1561 4.1.2 | Company Officer 6e Ch 4
        </p>
      </div>
    </details>
    <details>
      <summary>Fire Attack & Tactics</summary>
      <div class="details-content">
        <ul>
          <li>Select proper hoseline: 1¾" (150–175 gpm) or 2½" (200–250 gpm).</li>
          <li>Coordinate ventilation prior to interior attack.</li>
          <li>Maintain backup line; assign RIT per SOP.</li>
        </ul>
        <p class="references">
          SOP 900.11 | Essentials 7e Ch 14 p 325 | NFPA 1710 5.2.4 | Company Officer 6e Ch 6
        </p>
      </div>
    </details>
  </section>

  <section id="hazmat">
    <h2>☣️ Hazardous Materials Response</h2>
    <details>
      <summary>ERG Guidance & Isolation</summary>
      <div class="details-content">
        <ul>
          <li>Identify product via placard/ERG book; review Table 1-2 isolation distances.</li>
          <li>Isolate scene: initial isolation 100 m for spills, 800 m for fires.</li>
          <li>Don Level A or B PPE with SCBA.</li>
        </ul>
        <p class="references">
          SOP 1000.01 | ERG 2024 p 123 | NFPA 472 Chapter 4 | Company Officer 6e Ch 10
        </p>
      </div>
    </details>
    <details>
      <summary>Mitigation & Decontamination</summary>
      <div class="details-content">
        <ul>
          <li>Set up hot/warm/cold zones; control entry.</li>
          <li>Perform gross decon (remove outer gear) then technical decon per SOP 1000.02.</li>
          <li>Contain runoff; notify environmental agencies.</li>
        </ul>
        <p class="references">
          SOP 1000.02 | ERG 2024 p 156 | NFPA 1991 Sec 6.3 | Essentials 7e Ch 15 p 350
        </p>
      </div>
    </details>
  </section>

  <section id="ems">
    <h2>🚑 Emergency Medical Services</h2>
    <details open>
      <summary>Adult Cardiac Arrest</summary>
      <div class="details-content">
        <ul>
          <li>High-quality CPR: 100–120 cpm, 5–6 cm depth, full recoil.</li>
          <li>Rotate compressors every 2 minutes; minimize pauses & ventilations.</li>
          <li>AED: Analyze rhythm, follow shock/no-shock algorithm.</li>
          <li>Post-ROSC: target SBP > 90 mmHg, SpO₂ 94–99%.</li>
        </ul>
        <div class="callout">Confirm DNR before initiating resuscitation (<a href="#sop-130004">SOP 1300.4</a>).</div>
        <p class="references">
          SOP 1300.1 | NREMT Algorithm Adult CA | Essentials 7e Ch 20 p 420 | NFPA 1917 8.4.2
        </p>
      </div>
    </details>
    <details>
      <summary>Stroke Assessment & Transport</summary>
      <div class="details-content">
        <ul>
          <li>FAST exam: Face, Arm, Speech, Time.</li>
          <li>Check blood glucose; < 60 mg/dL requires dextrose.</li>
          <li>Notify stroke center, provide last-known-well time.</li>
        </ul>
        <p class="references">
          SOP 1300.3 | KBEMS Stroke Protocol 2024 | Essentials 7e Ch 18 p 380 | NFPA 1917 8.6.1
        </p>
      </div>
    </details>
    <details>
      <summary>Pediatric Care</summary>
      <div class="details-content">
        <ul>
          <li>Use Broselow tape; weight-based drug dosing.</li>
          <li>CPR compressions: one-third AP diameter, 100–120 cpm.</li>
          <li>IV/IO access: IO if IV unsuccessful > 90 s.</li>
        </ul>
        <p class="references">
          SOP 1300.9 | NREMT PALS Guidelines 2023 | Essentials 7e Ch 22 p 470 | NFPA 1901
        </p>
      </div>
    </details>
    <details>
      <summary>Airway Management</summary>
      <div class="details-content">
        <ul>
          <li>Adjuncts: OPA/NPA; two-person BVM with 100% O₂.</li>
          <li>Confirm with ETCO₂ waveform, target 35–45 mmHg.</li>
          <li>RSI: etomidate (0.3 mg/kg) + succinylcholine (1–1.5 mg/kg) per medical control.</li>
        </ul>
        <p class="references">
          Essentials 7e Ch 17 p 360 | NFPA 1917 8.2 | NREMT Airway Skill Sheet | SOP 1300.8
        </p>
      </div>
    </details>
    <details>
      <summary>DNR & End-of-Life</summary>
      <div class="details-content">
        <ul>
          <li>Verify valid DNR; consult medical control if unclear.</li>
          <li>Document source, time, and personnel verifying.</li>
        </ul>
        <p class="references">
          SOP 1300.4 | KBEMS DNR Policy 2024 | Essentials 7e Ch 21 p 440
        </p>
      </div>
    </details>
  </section>

  <section id="pump">
    <h2>🚒 Pump Operations</h2>
    <details>
      <summary>Engine Pumping & Pressure</summary>
      <div class="details-content">
        <ul>
          <li>Intake: pump pressure + static pressure (PSI).</li>
          <li>Nozzle pressure: 100 psi for fog, 50 psi for smooth bore.</li>
          <li>Friction loss: 2 psi/100 ft @ 500 gpm, adjust for flow.</li>
        </ul>
        <p class="references">
          Essentials 7e Ch 16 p 300 | NFPA 1901 Sec 6.7 | Company Officer 6e Ch 12 | SOP 500.01
        </p>
      </div>
    </details>
    <details>
      <summary>Mobile Water Supply</summary>
      <div class="details-content">
        <ul>
          <li>Relay pumping: tandem, mid-point, shuttle methods.</li>
          <li>Tanker shuttle: ensure fill site safety & traffic control.</li>
        </ul>
        <p class="references">
          SOP 500.06 | Essentials 7e Ch 16 p 310 | NFPA 1901 Sec 6.8
        </p>
      </div>
    </details>
  </section>

  <section id="aerial">
    <h2>🛗 Aerial Operations</h2>
    <details>
      <summary>Ladder Placement & Stabilization</summary>
      <div class="details-content">
        <ul>
          <li>Outriggers fully deployed; level within 5°.</li>
          <li>75° angle (1:4 ratio) from ground for climb stability.</li>
        </ul>
        <p class="references">
          SOP 1100.2 | Essentials 7e Ch 13 p 360 | NFPA 1901 Sec 7.5
        </p>
      </div>
    </details>
    <details>
      <summary>Tip Load & Climbing Safety</summary>
      <div class="details-content">
        <ul>
          <li>Observe manufacturer tip load limits; limit personnel.</li>
          <li>Three points of contact at all times.</li>
        </ul>
        <p class="references">
          NFPA 1904 | SOP 1100.2 | Company Officer 6e Ch 10
        </p>
      </div>
    </details>
  </section>

  <section id="mutual">
    <h2>🤝 Mutual Aid Procedures</h2>
    <details>
      <summary>Request & Deployment</summary>
      <div class="details-content">
        <ul>
          <li>Contact mutual aid via dispatch channel; use ICS 205 plan.</li>
          <li>Track resources via ICS 204; record arrival/assignment.</li>
        </ul>
        <p class="references">
          SOP 900.21 | Essentials 7e Ch 5 p 120 | NFPA 1561 4.2.3
        </p>
      </div>
    </details>
  </section>

  <section id="mapping">
    <h2>🗺️ RHQC Mapping System</h2>
    <a class="button" href="https://omnivoir.github.io/RHQC-System/" target="_blank">Open RHQC Map</a>
  </section>

  <section id="sopembed">
    <h2>📘 HFD SOPs Reference & PDF</h2>
    <ul id="sop-list">
      <li id="sop-900044"><strong>SOP 900.44:</strong> Structure Fire Operations</li>
      <li id="sop-1000002"><strong>SOP 1000.02:</strong> Hazmat Decontamination</li>
      <li id="sop-130001"><strong>SOP 1300.1:</strong> EMS Orientation & Protocols</li>
      <li id="sop-130003"><strong>SOP 1300.3:</strong> Contact of Medical Control</li>
      <li id="sop-130004"><strong>SOP 1300.4:</strong> Destination & DNR</li>
      <li id="sop-130009"><strong>SOP 1300.9:</strong> Pediatric Transport</li>
      <li id="sop-50001"><strong>SOP 500.01:</strong> Safe Operation of Fire Apparatus</li>
      <li id="sop-900021"><strong>SOP 900.21:</strong> Mutual Aid Requests</li>
      <!-- add more SOPs as needed -->
    </ul>
    <object class="pdf-object" data="HFD_SOP_Effective_9-26-24.pdf" type="application/pdf">
      <p>PDF not supported. <a href="HFD_SOP_Effective_9-26-24.pdf" target="_blank">Open SOP PDF</a>.</p>
    </object>
  </section>

</main>

<footer>
  <p>&copy; Hopkinsville Fire Department – Universal Master Reference</p>
</footer>

</body>
</html>
"""

# Write the updated HTML file
Path('/mnt/data/index.html').write_text(html_content)
print("Updated index.html with full references and fixed SOP embed.")
