<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Universal Emergency Response Compendium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Reset & base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f2f2f2; color: #333; }
    header { background: #b22234; color: #fff; padding: 1.5rem; text-align: center; }
    header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    header p { font-size: 1rem; opacity: 0.9; }
    nav { background: #3c3b6e; }
    nav ul { display: flex; flex-wrap: wrap; justify-content: center; list-style: none; }
    nav li { margin: 0.5rem 1rem; }
    nav a { color: #fff; text-decoration: none; font-weight: 600; }
    main { max-width: 960px; margin: 2rem auto; padding: 0 1rem; }
    section { margin-bottom: 2rem; border-radius: 8px; overflow: hidden; background: #fff;
               box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    section h2 { background: #003399; color: #fff; padding: 1rem; font-size: 1.6rem; }
    details { border-top: 1px solid #ddd; }
    summary { cursor: pointer; padding: 1rem; font-weight: 600; background: #e9ecef; transition: background 0.2s; }
    summary:hover { background: #dee2e6; }
    .details-content { padding: 1rem; border-top: 1px solid #ccc; }
    .details-content ul { margin: 0.5rem 0 0.5rem 1.2rem; list-style: disc; }
    .callout { border-left: 4px solid #b22234; background: #fff3f3; padding: 0.8rem; margin: 1rem 0; font-style: italic; }
    .references { font-size: 0.9rem; margin-top: 1rem; color: #555; }
    .button { display: inline-block; margin: 1rem 0; background: #b22234; color: #fff; padding: 0.6rem 1.2rem; text-decoration: none; border-radius: 4px; font-weight: 600; }
    footer { text-align: center; padding: 1rem; background: #3c3b6e; color: #fff; font-size: 0.9rem; }
    .pdf-embed, .pdf-object { width: 100%; height: 600px; border: none; }
    #sop-list li { margin-bottom: 0.5rem; }
    #sop-list strong { color: #b22234; }
  </style>
</head>   
<style>
  /* === Scenario Generator & PDF Embed Styles === */
  #scenario-generator {
    background: #f8faff;
    border: 1px solid #ccddee;
    padding: 1rem;
    margin: 2rem 0;
    border-radius: 8px;
  }
  #scenario-generator h2 {
    color: #003366;
  }
  #scenario-generator select,
  #scenario-generator button {
    margin: 0.5rem 0;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    border: 1px solid #888;
    font-size: 1rem;
  }
  #scenario-card {
    margin-top: 1rem;
  }
  .scenario-text,
  .answer-text {
    background: #ffffff;
    border: 1px solid #aaa;
    padding: 1rem;
    border-radius: 4px;
    margin: 0.5rem 0;
  }
  .pdf-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* 16:9 aspect */
    margin-top: 1rem;
  }
  .pdf-container iframe {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }
  .hidden { display: none; }
/* === Mission Statement Section === */
#mission {
  background: #f8faff;
  border: 1px solid #ccddee;
  margin-top: 2rem;
  padding: 2rem;
  border-radius: 8px;
  text-align: center;
}
#mission h2 {
  margin-bottom: 1rem;
}
#mission p {
  max-width: 800px;
  margin: 0 auto;
  font-size: 1rem;
  line-height: 1.6;
  color: #444;
}
</style>
<body>

<header>
  <h1>Universal Emergency Response Compendium</h1>
  <p>Your all-in-one SOP-driven resource for Fire, EMS, Hazmat & Command</p>
</header>

<nav>
  <ul>
    <li><a href="#fire">Structure Fire</a></li>
    <li><a href="#hazmat">Hazmat</a></li>
    <li><a href="#ems">EMS</a></li>
    <li><a href="#pump">Pump Ops</a></li>
    <li><a href="#aerial">Aerial Ops</a></li>
    <li><a href="#mutual">Mutual Aid</a></li>
    <li><a href="#mapping">RHQC Map</a></li>
    <li><a href="#sopembed">HFD SOPs</a></li>
  </ul>
</nav>

<main>

  <section id="fire">
    <h2>üî• Structure Fire Operations</h2>
    <details>
      <summary>Size-up & Risk Assessment</summary>
      <div class="details-content">
        <ul>
          <li>Establish command & location.</li>
          <li>Identify structure type, occupancy, exposures.</li>
          <li>Check water supply & hydrant locations.</li>
          <li>Review pre-plans & construction details.</li>
        </ul>
        <div class="callout">
          <strong>NFPA¬†1710¬†5.2.2:</strong> First due engine‚Äîarrival & crew setup within 4‚ÄØmin; ensure 4‚Äëperson crew staffing per engine.
        </div>
        <p class="references">
          <strong>References:</strong>
          SOP¬†900.44 | Essentials¬†7e Ch‚ÄØ12 | NFPA¬†1710¬†5.2.2 | Company Officer¬†6e¬†Ch‚ÄØ3
        </p>
      </div>
    </details>
    <details>
      <summary>Incident Command & ICS</summary>
      <div class="details-content">
        <ul>
          <li>Implement NIMS ICS: Command, Ops, Logistics, Planning, Finance.</li>
          <li>Establish divisions/zones; ensure 4‚Äâ√ó‚Äâ4 accountability tags.</li>
          <li>PAR every 15‚ÄØminutes; document on ICS¬†201/202 forms.</li>
        </ul>
        <div class="callout">
          <strong>Company Officer¬†6e¬†Ch‚ÄØ4:</strong> Assign clear ICS roles, maintain communication via tactical worksheets.
        </div>
        <p class="references">
          SOP¬†900.03 | Essentials¬†7e Ch‚ÄØ2 | NFPA¬†1561¬†4.1.2 | Company Officer¬†6e¬†Ch‚ÄØ4
        </p>
      </div>
    </details>
    <details>
      <summary>Fire Attack & Tactics</summary>
      <div class="details-content">
        <ul>
          <li>Select proper hoseline: 1¬æ" (150‚Äì175‚ÄØgpm) or 2¬Ω" (200‚Äì250‚ÄØgpm).</li>
          <li>Coordinate ventilation before interior attack.</li>
          <li>Maintain backup line; assign RIT per SOP.</li>
        </ul>
        <div class="callout">
          <strong>Essentials¬†7e¬†Ch‚ÄØ14:</strong> Advance hoseline with a two‚Äëin/two‚Äëout safety rule; control fire flow rates.
        </div>
        <p class="references">
          SOP¬†900.11 | Essentials¬†7e Ch‚ÄØ14 | NFPA¬†1710¬†5.2.4 | Company Officer¬†6e¬†Ch‚ÄØ6
        </p>
      </div>
    </details>
  </section>

<!-- ‚îÄ‚îÄ‚îÄ Include JSZip from CDN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>

<!-- ‚îÄ‚îÄ‚îÄ ERG Viewer + HazMat Lookup Section ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section id="erg-hazmat">
  <h2>üìò Emergency Response Guidebook & HazMat Lookup</h2>

  <!-- PDF Viewer -->
  <div class="pdf-container" style="width:100%; height:600px; border:1px solid #ddd;">
    <iframe
      id="erg-frame"
      src=""
      title="ERG 2024 PDF"
      style="width:100%; height:100%; border:none;"
    ></iframe>
  </div>

  <!-- HazMat Lookup -->
  <div style="padding:1rem; margin-top:1.5rem; border:1px solid #ddd; background:#f9f9f9;">
    <label for="hz-input">Enter UN/NA # or Name:</label><br>
    <input
      type="text"
      id="hz-input"
      placeholder="e.g. 1203 or Gasoline"
      style="width:18rem; margin-top:0.5rem;"
    >
    <button id="hz-go" style="margin-left:0.5rem;">Lookup</button>
    <pre id="hz-output"
         style="margin-top:1rem; white-space:pre-wrap; font-family:monospace;"></pre>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // 1) Mini‚Äêdatabase of ERG entries
  const ergIndex = {
    "1005": { name:"Anhydrous Ammonia", guide:"125",
               isolation:{yellow:"25‚Äì75 m",orange:"800 m",red:"800 m"},
               protectiveActions:"Shut off valve; water spray to disperse vapor; isolate downwind per Table 1.",
               firstAid:"Move victim to fresh air; treat for inhalation." },
    "1017": { name:"Chlorine", guide:"124",
               isolation:{yellow:"30‚Äì50 m",orange:"800 m",red:"800 m"},
               protectiveActions:"Water spray curtain; avoid breathing vapor; isolate downwind per Table 1.",
               firstAid:"Flush eyes/skin with water; move to fresh air." },
    "1203": { name:"Gasoline", guide:"128",
               isolation:{yellow:"25‚Äì75 m",orange:"800 m",red:"800 m"},
               protectiveActions:"Eliminate ignition; dike with foam; use AFFF; isolate per Table 1.",
               firstAid:"Remove contaminated clothing; flush skin with water." }
    // ‚Üê add more entries here as needed
  };

  // 2) Fetch & unzip your ERG.zip -> PDF blob URL
  let pdfBlobUrl = null;
  JSZip.loadAsync(fetch('pdfs/ERG.zip').then(r=>r.arrayBuffer()))
    .then(zip => {
      // find the PDF inside
      const pdfName = Object.keys(zip.files).find(n=>n.match(/\.pdf$/i));
      return zip.file(pdfName).async('blob');
    })
    .then(blob => {
      pdfBlobUrl = URL.createObjectURL(blob);
      // initial load (fit width)
      document.getElementById('erg-frame').src = pdfBlobUrl + '#view=FitH';
    })
    .catch(err => console.error('Failed to load ERG zip:', err));

  // 3) HazMat lookup DOM refs
  const input  = document.getElementById('hz-input');
  const button = document.getElementById('hz-go');
  const output = document.getElementById('hz-output');
  const iframe = document.getElementById('erg-frame');

  // 4) On button click: lookup & jump PDF
  button.addEventListener('click', () => {
    const raw = input.value.trim();
    if (!raw) {
      output.textContent = '‚ö†Ô∏è Please enter a UN/NA number or name.';
      return;
    }
    // try UN/NA number
    const key = raw.split(/\s*-\s*/)[0];
    let e = ergIndex[key]
         || Object.values(ergIndex).find(o=>o.name.toLowerCase()===raw.toLowerCase());
    if (!e) {
      output.textContent = `‚ö†Ô∏è No ERG entry found for ‚Äú${raw}‚Äù.`;
      return;
    }

    // display text
    output.textContent =
`Name: ${e.name}
UN/NA: ${key}
ERG Guide: ${e.guide}

Initial Isolation Distances:
 ‚Ä¢ Small Spill (Yellow): ${e.isolation.yellow}
 ‚Ä¢ Large Spill (Orange): ${e.isolation.orange}
 ‚Ä¢ Fire (Red):            ${e.isolation.red}

Protective Actions:
  ${e.protectiveActions}

First Aid:
  ${e.firstAid}`;

    // jump iframe to that guide page (once blob is ready)
    if (pdfBlobUrl) {
      iframe.src = pdfBlobUrl + '#page=' + e.guide;
    }
  });
});
</script>




<section id="pump-ops">
  <h2>üöí Pump Operations</h2>

  <!-- 1) Quick Reference Chart -->
  <details>
    <summary>Quick Reference: Friction Coefficients</summary>
    <table style="width:100%;border-collapse:collapse;margin:0.5rem 0;">
      <thead>
        <tr>
          <th style="border:1px solid #ccc;padding:0.5rem">Item</th>
          <th style="border:1px solid:#ccc;padding:0.5rem">Coefficient / Loss</th>
        </tr>
      </thead>
      <tbody>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">1¬æ‚Ä≥ Hose</td><td style="border:1px solid:#ccc;text-align:center">15.5</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">2¬Ω‚Ä≥ Hose</td><td style="border:1px solid:#ccc;text-align:center">2.0</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">3‚Ä≥ LDH Hose</td><td style="border:1px solid:#ccc;text-align:center">0.08</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">5‚Ä≥ LDH Hose</td><td style="border:1px solid:#ccc;text-align:center">0.02</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Fog Nozzle</td><td style="border:1px solid:#ccc;text-align:center">0.08</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Smooth-Bore Nozzle</td><td style="border:1px solid:#ccc;text-align:center">0.08</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Master-Stream Device</td><td style="border:1px solid:#ccc;text-align:center">0.20</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Gated Wye</td><td style="border:1px solid:#ccc;text-align:center">10 psi</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Siamese Connection</td><td style="border:1px solid:#ccc;text-align:center">5 psi</td></tr>
        <tr><td style="border:1px solid:#ccc;padding:0.5rem">Elevation</td><td style="border:1px solid:#ccc;text-align:center">0.5 psi/ft</td></tr>
      </tbody>
    </table>
    <p class="references"><strong>Sources:</strong> NFPA 1901 2022; IFSTA Pumping Apparatus Driver/Operator Handbook 5e; Fire Engineering Friction-Loss Tables</p>
  </details>

  <!-- 2) Fire-Flow Calculator (unchanged) -->
  <details open>
    <summary>Fire-Flow Calculator</summary>
    <div style="padding:1rem;border:1px solid #ddd;background:#f9f9f9;">
      <p>Flow = (Length √ó Width √∑ 3) √ó Floors</p>
      <input type="number" id="ff-l" placeholder="Length (ft)" style="width:6rem">
      <input type="number" id="ff-w" placeholder="Width (ft)" style="width:6rem">
      <input type="number" id="ff-f" placeholder="Floors" style="width:4rem">
      <button id="ff-go">Calculate</button>
      <p id="ff-res" style="font-weight:600;margin-top:0.5rem;"></p>
      <p id="ff-rec" style="margin-top:0.5rem;color:#333;"></p>
    </div>
    <p class="references"><strong>Sources:</strong> IFSTA Essentials of Firefighting 8e; NFPA 1901 2022</p>
  </details>

  <!-- 3) Friction-Loss Calculator -->
  <details>
    <summary>Friction-Loss Calculator</summary>
    <div style="padding:1rem;border:1px solid #ddd;background:#f9f9f9;">
      <p>Add as many hose/nozzle lines as you need ‚Äî it will show friction loss, PDP, and total GPM.</p>
      <div id="fl-lines"></div>
      <button id="fl-add">+ Add Line</button>
      <hr>
      <button id="fl-calc">Calculate All</button>
      <pre id="fl-out" style="font-weight:600;white-space:pre-wrap;"></pre>
    </div>
    <p class="references"><strong>Sources:</strong> IFSTA Pumping Apparatus Driver/Operator Handbook 5e; NFPA 1901 Friction Tables</p>
  </details>

  <!-- 4) Operation Simulator -->
  <details>
    <summary>Pump-Ops Simulator</summary>
    <div style="padding:1rem;border:1px solid #ddd;background:#f9f9f9;">
      <!-- Step 1 -->
      <h4>Step 1: Required Flow & Truck Specs</h4>
      <input type="number" id="op-req" placeholder="Required GPM" style="width:6rem">
      <input type="number" id="op-tank" placeholder="Tank Cap (GPM)" style="width:6rem">
      <input type="number" id="op-pump" placeholder="Pump Cap (GPM)" style="width:6rem">
      <input type="number" id="op-maxpsi" placeholder="Max PSI" style="width:6rem">
      <hr>
      <!-- Step 2: Hydrants -->
      <h4>Step 2: Hydrants (5‚Ä≥/0.9 assumed)</h4>
      <div id="hz-lines"></div>
      <button id="hz-add">+ Add Hydrant</button>
      <hr>
      <!-- Step 3: Discharges -->
      <h4>Step 3: Build Your Discharges</h4>
      <div id="sim-lines"></div>
      <button id="sim-add">+ Add Line</button>
      <hr>
      <!-- Final Check -->
      <button id="sim-go">Evaluate Flow</button>
      <pre id="sim-out" style="font-weight:600;white-space:pre-wrap;"></pre>
    </div>
    <p class="references"><strong>Sources:</strong> NFPA 1901 2022; IFSTA Pumping Apparatus Driver/Operator 5e; Fire Engineering Pump-Ops Guide</p>
  </details>
</section>

<script>
(() => {
  // 2) Fire-Flow (unchanged)
  document.getElementById('ff-go').onclick = () => {
    const L = +document.getElementById('ff-l').value,
          W = +document.getElementById('ff-w').value,
          F = +document.getElementById('ff-f').value;
    if (!L||!W||!F) { return alert('Enter all fields'); }
    const G = Math.ceil((L*W/3)*F),
          rec = document.getElementById('ff-rec'),
          res = document.getElementById('ff-res');
    res.textContent = `Required Flow: ${G} GPM`;
    let setup = '';
    if (G<=1000) setup='‚Ä¢ Use 1 monitor (1,000 gpm)';
    else if (G<=2000) setup='‚Ä¢ 1 monitor + 4 handlines (250 gpm each)';
    else if (G<=3000) setup='‚Ä¢ 1 aerial monitor + 3 handlines';
    else setup='‚Ä¢ 2 monitors + 1 aerial monitor + 4 handlines';
    rec.textContent = `Suggested setup:\n${setup}`;
  };

  // 3) Friction-Loss Calculator
  const FL_COEFF = {
    '1¬æ"':15.5, '2¬Ω"':2.0, '3"':0.08, '5"':0.02
  };
  const NOZZLE = {
    'Fog (100 psi)':100,
    'Smooth Bore (50 psi)':50,
    'Master Stream (80 psi)':80,
    'Deck Gun (80 psi)':80,
    'Aerial Device (80 psi)':80
  };
  function createFLLine() {
    const div = document.createElement('div');
    div.innerHTML = `
      <select class="fl-hose">
        ${Object.keys(FL_COEFF).map(h=>`<option>${h}</option>`).join('')}
      </select>
      <input type="number" class="fl-gpm" placeholder="GPM">
      <input type="number" class="fl-len" placeholder="Length (ft)">
      <select class="fl-noz">
        ${Object.entries(NOZZLE).map(([k,v])=>`<option data-np="${v}">${k}</option>`).join('')}
      </select>
      <button class="fl-rem">√ó</button>
      <p class="fl-line-out" style="margin:0.5rem 0;"></p>
    `;
    div.querySelector('.fl-rem').onclick = ()=>div.remove();
    document.getElementById('fl-lines').append(div);
  }
  document.getElementById('fl-add').onclick = createFLLine;
  createFLLine();

  document.getElementById('fl-calc').onclick = () => {
    const lines = document.querySelectorAll('#fl-lines > div');
    let totalGPM=0, output='';
    lines.forEach((d,i) => {
      const hose = d.querySelector('.fl-hose').value,
            C = FL_COEFF[hose],
            Q = +d.querySelector('.fl-gpm').value,
            L = +d.querySelector('.fl-len').value,
            NP = +d.querySelector('.fl-noz').selectedOptions[0].dataset.np,
            FL = +(C*(Q/100)**2*(L/100)).toFixed(1),
            PDP = +(FL+NP).toFixed(1);
      totalGPM += Q;
      output += `Line ${i+1}: FL ${FL} psi ¬∑ NP ${NP} psi ‚Üí PDP ${PDP} psi ¬∑ ${Q} GPM\n`;
      // warnings
      if (PDP > +document.getElementById('op-maxpsi')?.value) 
        output += `  ‚ö†Ô∏è PDP above pump max psi!\n`;
    });
    output += `\nTotal GPM of lines: ${totalGPM}\n`;
    document.getElementById('fl-out').textContent = output;
  };

  // 4) Pump-Ops Simulator
  let hzCount=0, lineCount=0;
  function addHydrant() {
    const div = document.createElement('div');
    div.innerHTML = `
      <input type="number" class="hz-psi" placeholder="Pitot (psi)">
      <button class="hz-rem">√ó</button>
      <p class="hz-out" style="margin:0.5rem 0;"></p>
    `;
    div.querySelector('.hz-rem').onclick = ()=>div.remove();
    document.getElementById('hz-lines').append(div);
  }
  document.getElementById('hz-add').onclick = addHydrant;
  addHydrant();

  function addSimLine() {
    const div = document.createElement('div');
    div.innerHTML = `
      <select class="sl-hose">
        <option value="15.5">1¬æ‚Ä≥</option>
        <option value="2.0">2¬Ω‚Ä≥</option>
        <option value="0.08">3‚Ä≥</option>
        <option value="0.02">5‚Ä≥</option>
      </select>
      <input type="number" class="sl-gpm" placeholder="GPM">
      <input type="number" class="sl-len" placeholder="Length (ft)">
      <select class="sl-np">
        <option value="50">50 psi nozzle</option>
        <option value="100">100 psi nozzle</option>
      </select>
      <button class="sl-rem">√ó</button>
    `;
    div.querySelector('.sl-rem').onclick = ()=>div.remove();
    document.getElementById('sim-lines').append(div);
  }
  document.getElementById('sim-add').onclick = addSimLine;
  addSimLine();

  document.getElementById('sim-go').onclick = () => {
    const req = +document.getElementById('op-req').value,
          tank = +document.getElementById('op-tank').value,
          pumpCap = +document.getElementById('op-pump').value,
          maxpsi = +document.getElementById('op-maxpsi').value;
    if (!req||!tank||!pumpCap||!maxpsi) return alert('Fill in Steps 1 fully');
    // hydrant supply
    let hydrantSupply = 0;
    document.querySelectorAll('#hz-lines > div').forEach(d => {
      const psi = +d.querySelector('.hz-psi').value;
      if (psi) {
        const gpm = Math.round(29.84 * 5 * 0.9 * Math.sqrt(psi));
        hydrantSupply += gpm;
        d.querySelector('.hz-out').textContent = `Hydrant: ${gpm} GPM`;
      }
    });
    // total supply
    const supply = Math.min(pumpCap, tank + hydrantSupply);
    // demand
    let demand=0, details='';
    document.querySelectorAll('#sim-lines > div').forEach((r,i) => {
      const C = +r.querySelector('.sl-hose').value,
            Q = +r.querySelector('.sl-gpm').value,
            L = +r.querySelector('.sl-len').value,
            NP = +r.querySelector('.sl-np').value,
            FL = +(C*(Q/100)**2*(L/100)).toFixed(1),
            PDP = +(FL+NP).toFixed(1);
      demand += Q;
      details += `Line ${i+1}: GPM ${Q}, PDP ${PDP} psi\n`;
      if (PDP > maxpsi) details += `  ‚ö†Ô∏è Overpressure!\n`;
    });
    // output
    let out = `Total Output: ${supply} GPM ‚Ä¢ Required: ${req} GPM\n\n${details}`;
    if (supply < req) {
      out += `‚ùå Short by ${req - supply} GPM\n\nSuggestions:\n‚Ä¢ Add another hydrant or use larger LDH intake.\n‚Ä¢ Reduce hose length or use larger diameter hose.\n‚Ä¢ Use lower-pressure nozzle or adjust GPM.\n`;
    } else {
      out += `‚úÖ Required flow met!`;
    }
    document.getElementById('sim-out').textContent = out;
  };
})();
</script>





  <section id="aerial">
    <h2>üõó Aerial Operations</h2>
    <details>
      <summary>Ladder Placement & Stabilization</summary>
      <div class="details-content">
        <ul>
          <li>Deploy outriggers on firm ground; level within 5¬∞.</li>
          <li>Set ladder at 75¬∞ (1:4 ratio) for optimal climb angle.</li>
        </ul>
        <div class="callout">
          <strong>NFPA¬†1901¬†7.5:</strong> Outrigger pads minimum 18√ó18‚ÄØin; inspect ground pad condition.
        </div>
        <p class="references">
          SOP¬†1100.2 | Essentials¬†7e¬†Ch‚ÄØ13 | NFPA¬†1901¬†7.5
        </p>
      </div>
    </details>
    <details>
      <summary>Tip Load & Climbing Safety</summary>
      <div class="details-content">
        <ul>
          <li>Observe manufacturer tip load limits; no more than 2 personnel at tip.</li>
          <li>Maintain three points of contact; don harness & lanyard properly.</li>
        </ul>
        <div class="callout">
          <strong>NFPA¬†1904¬†:</strong> Verify aerial device certification date; inspect fall protection equipment before use.
        </div>
        <p class="references">
          Company Officer¬†6e¬†Ch‚ÄØ10 | NFPA¬†1904 | SOP¬†1100.2
        </p>
      </div>
    </details>
  </section>

  <section id="nims-triage-masscasualty">
  <h2>üö® NIMS, Triage & Mass Casualty Response</h2>

  <details>
    <summary>NIMS Command Overview</summary>
    <div class="details-content">
      <ul>
        <li>Establish Incident Command: First arriving officer becomes IC per SOP 900.03.</li>
        <li>Set up ICS Structure: Command, Operations, Planning, Logistics, Finance/Admin.</li>
        <li>Start IAP (Incident Action Plan): Even if verbal for first ops period.</li>
        <li>Maintain Unity of Command: One supervisor per responder, no freelancing.</li>
      </ul>
      <div class="callout">
        <strong>Reference:</strong> NIMS 100/200 | SOP 900.03 | Essentials 7e Ch 2
      </div>
    </div>
  </details>

  <details>
    <summary>START Triage for Mass Casualty</summary>
    <div class="details-content">
      <ul>
        <li>Green (Minor): Walking wounded.</li>
        <li>Yellow (Delayed): Cannot walk but respirations <30, cap refill <2s, obeys commands.</li>
        <li>Red (Immediate): Breathing >30/min, cap refill >2s, or unable to follow commands.</li>
        <li>Black (Deceased/Expectant): Not breathing after airway reposition attempt.</li>
      </ul>
      <div class="callout">
        <strong>Reference:</strong> START Triage System | KBEMS MCI Protocol | Essentials 7e Ch 23
      </div>
    </div>
  </details>

  <details>
    <summary>Mass Casualty Incident (MCI) Priorities</summary>
    <div class="details-content">
      <ul>
        <li>Scene Safety: Hazards, secondary devices, structural collapse.</li>
        <li>Establish Triage Officer: Assign first competent medical responder.</li>
        <li>Request Resources: MCI Trailers, ambulances, air evac if needed.</li>
        <li>Coordinate Transport: Immediate transport for Red patients first.</li>
      </ul>
      <div class="callout">
        <strong>Reference:</strong> NIMS 700/800 | SOP 900.21 | NFPA 1561 | KBEMS MCI Policies
      </div>
    </div>
  </details>

  <details>
    <summary>Unified Command for Multi-Agency Response</summary>
    <div class="details-content">
      <ul>
        <li>Include Fire, EMS, Law Enforcement, EMA in Unified Command post.</li>
        <li>Share IAPs across disciplines to align priorities and safety plans.</li>
        <li>Use common radio channels assigned via ICS 205.</li>
      </ul>
      <div class="callout">
        <strong>Reference:</strong> NIMS 300/400 | SOP 900.07 | Company Officer 6e Ch 8
      </div>
    </div>
  </details>

</section>


  <section id="mapping">
    <h2>üó∫Ô∏è RHQC Mapping System</h2>
    <a class="button" href="https://omnivoir.github.io/RHQC-System/" target="_blank">Open RHQC Map</a>
  </section>

<section id="sopembed">
  <h2>üìò HFD SOPs Reference & PDF</h2>
  <ul id="sop-list">
    <!-- ‚Ä¶ your clickable SOP list ‚Ä¶ -->
  </ul>

  <!-- Simple ‚Äúview/download‚Äù link -->
  <p>
    <a 
      href="./HFD_SOP_Effective_9-26-24.pdf" 
      target="_blank" 
      rel="noopener"
      class="btn btn-primary"
    >
      üìÑ View/Download the full HFD SOP PDF
    </a>
  </p>
</section>
<section id="scenario-generator" class="module">
  <h2>üîÑ Random Training Scenario</h2>

  <label for="scenario-type">Choose a discipline:</label>
  <select id="scenario-type">
    <option value="fire">Structure Fire</option>
    <option value="hazmat">HazMat</option>
    <option value="ems">EMS</option>
    <option value="pump">Pump Ops</option>
  </select>

  <button id="generate-btn">Generate Scenario</button>

  <div id="scenario-card" class="hidden">
    <h3>Scenario:</h3>
    <p id="scenario-text" class="scenario-text"></p>
    <button id="reveal-btn">Reveal Model Answer</button>
    <div id="answer-text" class="answer-text hidden"></div>
  </div>
</section>
</main>
<section id="mission" class="bg-white p-6 rounded-lg shadow-md">
  <h2 class="text-2xl font-bold text-blue-900 text-center mb-4">üéØ Mission Statement</h2>
  <p class="text-center text-gray-700 max-w-3xl mx-auto leading-relaxed">
    The Universal Emergency Response Compendium is designed to strengthen the capabilities, knowledge, and decision-making skills of firefighters, EMTs, Hazmat technicians, and company officers by providing an integrated, accessible, and dynamic resource grounded in HFD SOPs, national standards, and real-world operational experience.<br><br>
    By unifying critical fireground operations, emergency medical procedures, hazardous materials response, and command-level protocols into a single, mobile-optimized platform, we aim to prepare today‚Äôs emergency responders for the extreme demands of modern incident response ‚Äî protecting lives, property, and each other.
  </p>
</section>
<footer>
  <p>&copy; Hopkinsville Fire Department ‚Äì Universal Emergency Response Compendium</p>
</footer>
<script>
// ‚îÄ‚îÄ‚îÄ Updated Scenario Bank ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const scenarios = {
  fire: [
    {
      text: "Engine 21 arrives at a 2-story garden-style apartment building with smoke showing from the C-D corner attic vents. What‚Äôs your 360¬∞ size-up and initial action?",
      answer: "Objective: Conduct 360¬∞‚Äîsize up collapse potential at C-corner overhang; confirm vent openings. Action: Deploy 1¬æ‚Äù hand line to A-side entrance under officer‚Äôs command.  \nSubjective: Following SOP 900.11 for Engine Company Ops and NFPA 1710, rapid interior attack keeps fire confined and limits extension to attic."
    },
    {
      text: "You‚Äôre first on scene to a working kitchen fire in a two-family home. The occupant reports possible upstairs occupants. What‚Äôs your primary search plan and hoseline choice?",
      answer: "Objective: 1) Assign a crew for search of reported bedrooms while attack line flows; 2) Stretch 1¬æ‚Äù cross-lay to kitchen doorway.  \nSubjective: Per SOP 900.07 (ICS) and SOP 900.08 (Mayday prep), simultaneous search & attack maximizes life safety and fire control."
    },
    {
      text: "A reported high-rise alarm: heavy smoke on floor 12, no fire confirmed. How do you establish lobby control and what standpipe prep do you order?",
      answer: "Objective: Lobby Officer secures elevator recall, radio comms; order 2¬Ω‚Äù hoseline to FDC and confirm standpipe pressure.  \nSubjective: Aligns with SOP 900.14 (High-Rise Ops) and NFPA 14‚Äîensures water supply before ascent."
    },
    {
      text: "You arrive at a residential fire with a visible attic fire. Aerial 23 is working but water supply is marginal. What‚Äôs your water-supply plan?",
      answer: "Objective: Pump to aerial master stream at 120 psi + FL; call for second engine to draft portable tank from hydrant 200‚Äô away.  \nSubjective: SOP 400.07 (Equipment securement) demands stable pump ops; portable tank bridging hydrants prevents supply interruption."
    },
    {
      text: "On a working fire, you observe heavy fire impinging on a bowstring-truss roof. What command action do you take?",
      answer: "Objective: Order an immediate personnel withdrawal and declare defensive mode, reposition apparatus for master streams.  \nSubjective: SOP 900.07 (Incident Command) requires rapid risk assessment; bowstring truss collapse is imminent and must be respected."
    },
    {
      text: "A crew‚Äôs inside with a 1¬æ‚Äù line but reports low psi and kinks. How do you fix it in-stream without canceling the flow?",
      answer: "Objective: Command shut-down nozzle, back-charge the line past kink, re-charge at pump at 50 psi, resume.  \nSubjective: SOP 500.02 (Ground guide) stresses pump-to-engine communication to maintain flow and safety."
    }
  ],

  hazmat: [
    {
      text: "A single leaking drum of corrosive acid is found in a warehouse. No placard. What‚Äôs your initial SOP-driven steps?",
      answer: "Objective: Isolate hot zone 50‚Äô, don Level C (APR + chem-resist suit per SOP 900.23), call HazMat Team.  \nSubjective: SOP 900.23 (Initial HazMat Mitigation) & ERG 154 ensure you protect self before ID or overpack."
    },
    {
      text: "A highway spill of liquid chlorine in a rail tank car. What ERG guide do you consult, and what evacuation distance?",
      answer: "Objective: ERG 112‚Äîlarge spill >100 lbs ‚Üí 800m (0.5 mile) downwind.  \nSubjective: Per SOP 900.23 and ERG, wind-driven chlorine tox cloud risks pulmonary injury."
    },
    {
      text: "You arrive to find ammonia leak in food-processing plant. Plant ops say shut-off is in machine room. How do you proceed?",
      answer: "Objective: Secure scene behind Level B perimeter, SCBA on, escort techs to shut-off, then decon per SOP 1000.02.  \nSubjective: SOP 400.12 (Infection/decon) and NFPA 473 require buddy-system & formal decon after ammonia workup."
    },
    {
      text: "Freon leak at supermarket‚Äîno fire, just vapor. What PPE and monitoring do you use?",
      answer: "Objective: Level C (APR) + PID gas monitor to keep below TLV (1000 ppm).  \nSubjective: SOP 900.23 directs minimum Level C for non-IDLH refrigerants; continuous monitoring prevents overexposure."
    },
    {
      text: "Bulk LPG tank is venting pressure-relief valve. What defensive tactic do you employ?",
      answer: "Objective: Position unmanned master stream at 200‚Äô away in runoff valley; cool adjacent tank dikes.  \nSubjective: SOP 500.01 (Apparatus ops) & NFPA 58 guidelines keep operators out of BLEVE range."
    },
    {
      text: "You‚Äôre called for a Class C electrical fire with transformer oil. Which extinguishing agent per SOP and NFPA?",
      answer: "Objective: Dry chem (NaHCO‚ÇÉ) per NFPA 17; avoid water stream on energized equipment.  \nSubjective: SOP 900.10 (Haz atmospheres) prohibits water; dry chem prevents reignition of oil-based fires."
    }
  ],

  ems: [
    {
      text: "Unresponsive 55 yo in VFib arrest. According to HFD SOP 1300.18 and AHA, outline your ACLS steps & meds.",
      answer: "Objective: Defib 200 J biphasic ‚Üí CPR 2 min ‚Üí epi 1 mg IV/IO ‚Üí CPR ‚Üí shock ‚Üí amio 300 mg if refractory.  \nSubjective: SOP 1300.18 Scope of Care mirrors AHA 2024, maximizing ROSC chances."
    },
    {
      text: "70 yo with sudden slurred speech & right-side weakness. What stroke scale & protocol?",
      answer: "Objective: Use C-STAT or Cincinnati scale; notify stroke center, keep SBP <180 per SOP 1300.12.  \nSubjective: SOP 1300.12 (Mandatory Reporting) forces rapid triage‚Äî'time is brain'."
    },
    {
      text: "3 yo child with febrile seizure lasting 3 mins, post-ictal. What‚Äôs your management per SOP 1300.15?",
      answer: "Objective: Protect airway, O‚ÇÇ via blow-by, obtain IV/IO, give midazolam 0.1 mg/kg IM if seizing >5 min.  \nSubjective: SOP 1300.15 (Patient Restraint) stresses gentleness in pediatrics‚Äîreassure parents."
    },
    {
      text: "Elderly diabetic found unresponsive, glucometer reads 35 mg/dL. What‚Äôs your next two actions?",
      answer: "Objective: Administer D50 IV (0.5 g/kg), recheck sugar q5 min.  \nSubjective: SOP 1300.08 (On-scene regs) demands prompt reversal‚Äîavoids neuronal damage."
    },
    {
      text: "Asthmatic, severe wheeze, speaking 1-word sentences. According to SOP 1300.09 & NREMT, what meds & transport decisions?",
      answer: "Objective: Nebulized albuterol 5 mg + ipratropium, consider CPAP if tolerated, expedite ALS transport.  \nSubjective: SOP 1300.09 (Safe ops) warns against delay‚Äîairway compromise can progress to arrest."
    },
    {
      text: "Active labor, second baby born breech. What‚Äôs your emergency OB protocol per SOP & AHA?",
      answer: "Objective: Support delivery‚Äîdon gloves, elevate hips, keep head down until shoulders deliver, prepare for neonatal resuscitation.  \nSubjective: SOP 1300.11 (Consent/Refusal) & PALS/BLS neonatal guidelines ensure gentle, controlled delivery."
    }
  ],

  pump: [
    {
      text: "Your engine is drafting from a static pond. What‚Äôs your step-by-step per SOP 500.08 to establish prime?",
      answer: "Objective: Inspect strainer, connect 3‚Äù suction, bleed air via priming valve, engage primer until 20‚Äù Hg, then throttle to 100 psi pump pressure.  \nSubjective: SOP 500.08 stresses no air leaks‚Äîmaintains uninterrupted supply."
    },
    {
      text: "Hydrant 150‚Äô away‚Äîattack crew flowing 200 gpm on 1¬æ‚Äù handline. FL is 15 psi. What pump discharge pressure?",
      answer: "Objective: PDP = NP (100 psi) + FL (15 psi) ‚Üí 115 psi.  \nSubjective: SOP 500.01 (Safe ops) demands correct PDP to avoid nozzle blowoff or insufficient flow."
    },
    {
      text: "You need to supply a master stream from E-24 to a second engine 500‚Äô back. How do you set up relay?",
      answer: "Objective: Engine-in hammer, lay supply line to engineer-in; maintain 20 psi residual in each relay; use gated wyes per SOP 500.02.  \nSubjective: NFPA 1962 relay standards ensure flow continuity over long distances."
    },
    {
      text: "Pump panel shows cavitation‚Äîgauge dropping to zero intermittently. What‚Äôs your immediate fix?",
      answer: "Objective: Close tank-to-pump valve, open fill-level valve, reduce throttle 200 rpm then reset.  \nSubjective: SOP 500.03 (Roadway Safety) reminds you‚Äîdon‚Äôt over-speed pump; cavitation damages seals."
    },
    {
      text: "Crew requests additional discharge for roof handline. You‚Äôre at 150 psi with 1¬æ‚Äù hose. What‚Äôs your nozzle and PDP adjustment?",
      answer: "Objective: Switch to smooth-bore 1¬Ω‚Äù tip (NP=50 psi) then throttle down to PDP=65 psi (50+15).  \nSubjective: SOP 400.07 belts & equipment rule‚Äîsmooth-bore reduces handler fatigue on elevated positions."
    },
    {
      text: "When supplying an aerial ladder from an engine pump, what gauge to monitor and SOP calls it out?",
      answer: "Objective: Watch the aerial master gauge (should be 100‚Äì125 psi) per SOP 500.01.  \nSubjective: NFPA 1901 & SOP 500.01 require stable pressure to prevent ladder water hammer."
    }
  ]
};
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// 2Ô∏è‚É£ Grab DOM elements:
const typeSel = document.getElementById("scenario-type");
const genBtn  = document.getElementById("generate-btn");
const card    = document.getElementById("scenario-card");
const textP   = document.getElementById("scenario-text");
const ansBtn  = document.getElementById("reveal-btn");
const ansDiv  = document.getElementById("answer-text");

// 3Ô∏è‚É£ Generate & show a random scenario:
genBtn.addEventListener("click", () => {
  const cat = typeSel.value;
  const pool = scenarios[cat];
  const pick = pool[Math.floor(Math.random()*pool.length)];
  textP.textContent = pick.text;
  ansDiv.textContent = pick.answer;
  ansDiv.classList.add("hidden");
  card.classList.remove("hidden");
  ansBtn.disabled = false;
});

// 4Ô∏è‚É£ Reveal the hidden answer:
ansBtn.addEventListener("click", () => {
  ansDiv.classList.remove("hidden");
  ansBtn.disabled = true;
});
</script>
</body>
</html>
